{% block api_js %}
    <!-- Google Maps API javascript -->
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
{% endblock %}

{% block html %}
    <!-- HTML map container -->
    <div id="map-canvas-{{ map.pk }}"
         {% if width and map.latitude and not map.geocode_error %}
            style="width: {{ width }}px; height: {{ height }}px;"
         {% endif %}
         class="easy-map-googlemap">
    </div>
{% endblock %}

{% block map_js %}
    <!-- Map creation script -->
    <script type="text/javascript">
        function initialize_map_{{ map.pk }}() {
            var latlng = new google.maps.LatLng({{ lokasi }});
            var mapElem = document.getElementById("map-canvas-{{ map.pk }}");

            {% block map_options_js %}
            var mapOptions = {
                zoom: {{ zoom }},
                center: latlng,
                mapTypeId: google.maps.MapTypeId.TERRAIN
            };
            {% endblock %}

            var map = new google.maps.Map(mapElem, mapOptions);

            {% block extra_js %}
            var positions = new Array();

            {% block set-positions %}{% endblock %}

            for (var i = 0; i < positions.length; i++) {
                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(positions[i][0], positions[i][1]),
                    map: map,
                    icon: '/images/map_marker_segitiga.png'
                });

                if (positions[i][2]) {
                    google.maps.event.addListener(marker, 'click', function() {
                        window.location = positions[i][2]; 
                        });
                }
            }

            {% block extra-marker %}{% endblock %}

            {% endblock %}
        }

        {% block map_loading_js %}
        // initialize the map after page loading
        google.maps.event.addDomListener(window, 'load', initialize_map_{{ map.pk }});
        {% endblock %}
    </script>
{% endblock %}
